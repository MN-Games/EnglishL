<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Language Parser</title>
</head>
<body>
    <form id="inputForm">
        <textarea id="inputText" rows="10" cols="50"></textarea>
        <button type="submit">Parse</button>
    </form>

    <popup></popup> <!-- Custom popup element -->

    <script>
        // Custom popup element implementation
        customElements.define('popup', class extends HTMLElement {
            connectedCallback() {
                this.innerHTML = `
                    <button onclick="openPopup()">Open Popup</button>
                    <div id="popup" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; padding: 20px; border: 1px solid black;">
                        <h2 id="popupTitle">Popup Title</h2>
                        <p id="popupContent">Popup Content</p>
                        <button onclick="closePopup()">Close Popup</button>
                    </div>
                `;
            }
        });

        // Function to open the popup
        function openPopup() {
            document.getElementById("popup").style.display = "block";
        }

        // Function to close the popup
        function closePopup() {
            document.getElementById("popup").style.display = "none";
        }

        document.getElementById('inputForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent form submission

            // Get the input text
            var inputText = document.getElementById('inputText').value;

            // Define a mapping of custom elements to their HTML equivalents
            var elementMappings = {
                'popup': '<popup>{content}</popup>',
                'header': '<header>{content}</header>',
                'footer': '<footer>{content}</footer>',
                'navigate': '<nav>{content}</nav>',
                'main': '<main>{content}</main>',
                'section': '<section>{content}</section>',
                'meta-info': '<meta-info>{content}</meta-info>',
                'link': '<a href="{url}">{content}</a>',
                'big-h': '<h1>{content}</h1>',
                'medium-h': '<h2>{content}</h2>',
                'h': '<h3>{content}</h3>',
                'small-h': '<h4>{content}</h4>',
                'tx': '<p>{content}</p>',
                'table': '<table>{content}</table>',
                'pic': '<img alt="{alt}" src="{src}">',
                'embed': '<embed src="{href}"></embed>'
            };

            // Replace custom elements with HTML equivalents
            var htmlOutput = inputText.replace(/<([^>]+)>(.*?)<\/\1>/g, function(match, tag, content) {
                // Check if the tag is mapped to an HTML equivalent
                if (elementMappings.hasOwnProperty(tag)) {
                    // Replace placeholders in the HTML equivalent with actual content
                    var htmlEquivalent = elementMappings[tag]
                        .replace('{content}', content)
                        .replace('{url}', extractAttributeValue(content, 'url'))
                        .replace('{alt}', extractAttributeValue(content, 'alt'))
                        .replace('{src}', extractAttributeValue(content, 'src'))
                        .replace('{href}', extractAttributeValue(content, 'href'));
                    return htmlEquivalent;
                } else {
                    // If not mapped, return the original match
                    return match;
                }
            });

            // Inject the parsed HTML into the custom popup element
            document.querySelector('popup').innerHTML = htmlOutput;
        });

        // Helper function to extract attribute value from a string
        function extractAttributeValue(content, attributeName) {
            var regex = new RegExp(attributeName + '="([^"]*)"');
            var match = regex.exec(content);
            return match ? match[1] : '';
        }
    </script>
</body>
</html>
